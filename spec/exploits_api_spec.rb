require "spec_helper"

RSpec.describe Shodanz::API::Exploits do
  include_context Async::RSpec::Reactor

  before do
    @client = Shodanz.api.exploits.new
  end

  before(:each) do
    # try to avoid rate limit
    sleep 3
  end

  describe '#search' do
    it 'should search across a variety of data sources for exploits' do
      reactor.async do
        resp = @client.search("SQL", port: 443).wait
        expect(resp).to be_a(Hash)
      end
    end
  end
end
